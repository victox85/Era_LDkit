import { DataFactory, fromRdf, toRdf } from "./rdf.js";
const df = new DataFactory();
const rdfToNativeHandlers = new Map();
const nativeToRdfHandlers = new Map();
/**
 * Registers a data type handler for translating between RDF literals and JavaScript values.
 *
 * In order to register a custom data type handler, the custom data type TypeScript mapping needs
 * to be added to the {@link CustomDataTypes} interface using module augmentation.
 *
 * Two handlers are required:
 * 1) A function to translate from RDF literal value (string) to JavaScript value.
 * 2) A function to translate from JavaScript value to RDF literal value (string).
 *
 * @example
 * ```typescript
 * import { registerDataHandler } from "ldkit";
 *
 * const customNumberDataType = "http://example.org/number";
 *
 * declare module "ldkit" {
 *   interface CustomDataTypes {
 *     [customNumberDataType]: number;
 *   }
 * }
 *
 * registerDataHandler(
 *   customNumberDataType,
 *   (literalValue: string) => parseInt(literalValue),
 *   (nativeValue: number) => nativeValue.toString(),
 * );
 * ```
 *
 * @param dataType - The data type to register.
 * @param translateFromRDF - Function to translate from RDF literal to JavaScript value.
 * @param translateToRDF - Function to translate from JavaScript value to RDF literal.
 */
export function registerDataHandler(dataType, translateFromRDF, translateToRDF) {
    rdfToNativeHandlers.set(dataType, translateFromRDF);
    nativeToRdfHandlers.set(dataType, translateToRDF);
}
export function translateFromRdf(literal) {
    const dataType = literal.datatype.value;
    const customHandler = rdfToNativeHandlers.get(dataType);
    if (customHandler) {
        return customHandler(literal.value);
    }
    else {
        return fromRdf(literal);
    }
}
export function translateToRdf(value, dataType) {
    const customHandler = nativeToRdfHandlers.get(dataType);
    if (customHandler) {
        return df.literal(customHandler(value), df.namedNode(dataType));
    }
    else {
        return toRdf(value, {
            datatype: df.namedNode(dataType),
        });
    }
}
